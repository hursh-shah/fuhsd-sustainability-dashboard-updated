<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Energy Consumption Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.7.4/lottie.min.js"></script>
    <script src="https://unpkg.com/@lottiefiles/lottie-interactivity@latest/dist/lottie-interactivity.min.js"></script>

    <style>
        html {
            scroll-behavior: smooth;
        }

        body {
            background-color: #f5f5f7;
            color: #333;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }

        .reveal {
            opacity: 0;
            transform: translateY(100px);
            transition: all 0.6s ease-in-out;
        }

        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }

        .fade-in {
            animation: fadeIn 2s forwards;
        }

        @keyframes fadeIn {
            0% {
                opacity: 0;
            }

            100% {
                opacity: 1;
            }
        }

        .fade-out {
            animation: fadeOut 3s forwards;
        }

        @keyframes fadeOut {
            0% {
                opacity: 1;
            }

            100% {
                opacity: 0;
            }
        }

        .arrow {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2rem;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%,
            20%,
            50%,
            80%,
            100% {
                transform: translateX(-50%) translateY(0);
            }

            40% {
                transform: translateX(-50%) translateY(-10px);
            }

            60% {
                transform: translateX(-50%) translateY(-5px);
            }
        }

        .section {
            margin: 560px 0;
        }

        .hvac-section {
            margin-top: 100px;
            margin-bottom: 1000px;
        }

        .bg-light-grey {
            background-color: #e0e0e0;
        }

        .text-dark-grey {
            color: #333;
        }

        .text-green {
            color: #2e7d32;
        }

        .text-9xl {
            font-size: 7rem;
        }

        .text-5xl {
            font-size: 4rem;
        }

        .text-2xl {
            font-size: 2rem;
        }

        .static-title {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2rem;
            font-weight: bold;
            display: none;
            color: #2e7d32;
        }

        .visible {
            display: block;
        }

        .navbar {
            background-color: #f5f5f7;
            color: #2e7d32;
            font-weight: bold;
            padding: 1rem;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            display: none;
        }

        .navbar.visible {
            display: flex;
            justify-content: center;
            gap: 1rem;
        }

        .nav-link {
            color: #2e7d32;
            font-size: 1.5rem;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <!-- Navigation Bar -->
    <nav id="navbar" class="navbar">
        <a class="nav-link" href="#hvac-section">HVAC</a>
        <a class="nav-link" href="#quick-stats-section">Quick Stats</a>
        <a class="nav-link" href="#energy-bar-chart-section">Energy Bar Chart</a>
        <a class="nav-link" href="#co2-chart-section">CO2 Emissions</a>
        <a class="nav-link" href="#usage-chart-section">Usage Chart</a>
    </nav>

    <!-- Big Heading -->
    <div class="hero bg-base-200 min-h-screen">
        <div class="hero-content text-center">
          <div class="max-w-lg">
            <h1 class="text-6xl font-bold">FUHSD Sustainability Data Dashboard</h1>
            <p class="py-6">
              This is a snapshot of FUHSD's environmental impact, analyzing real FUHSD data for the <span class="text-bold">2022-2023</span> school year. Scroll through to find interactives, dynamic charts, and visualizations of where we are as a district.
            </p>
            <button class="btn btn-primary" onclick="scrollDown(5)">Get Started</button>
          </div>
        </div>
            <div class="arrow text-green">↓</div>
    </div>

    <div id="static-title" class="static-title">FUHSD Sustainability</div>

    <!-- HVAC Section -->
    <div id="hvac-section" class="thermostat-container flex flex-row mx-20 my-10 space-x-6 reveal hvac-section">
        <div class="w-7/12">
            <article class="prose">
                <h1 class="text-dark-grey">HVAC is responsible for <span class="text-green">33%</span> of our energy
                    usage.</h1>
                <p class="text-dark-grey">One degree adjustment in HVAC can save energy equivalent to saving thousands of
                    trees.</p>
                <h3 class="font-bold text-dark-grey">Slide the thermometer up or down a few notches to see its carbon
                    impact!</h3>
                <p id="temperatureDisplay" class="text-2xl font-semibold text-dark-grey">Temperature: 72°F</p>
                <p id="co2Impact" class="text-5xl font-bold text-green">Trees saved: 0</p>
                <button class="btn bg-green-300 text-dark-grey text-2xl font-bold" id="switchSeason">Switch to Winter</button>
            </article>
        </div>
        <div class="thermostat-animation rounded-md" id="thermo-background">
            <div class="my-14" id="lottieThermometer"></div>
        </div>
    </div>

    <!-- Quick Stats Section -->
    <div id="quick-stats-section" class="flex flex-row section reveal">
        <div class="w-1/4 mx-auto my-auto">
            <div class="mb-8">
                <h2 class="text-7xl font-bold text-dark-grey mx-auto">7,075 mt</h2>
                <p class="text-md text-dark-grey mx-2">Amount of CO2e produced by FUHSD in the <span class="font-bold">past year</span>, calculated
                    from energy bill data</p>
            </div>
            <p class="text-xl text-dark-grey my-3">The data gathered from our energy bills indicates our current
                consumption trends and areas where we can improve. By analyzing these figures, we can devise strategies
                to enhance our energy efficiency and reduce overall emissions. </p>
            <!--<a class="text-2xl font-bold underline mt-2 text-green" href="#">Learn more</a>-->
        </div>
        <div class="w-1/4 mx-auto my-auto"> <!--trees-->
            <div class="mb-8">
                <div id="treeAnim"></div>
                <h2 class="text-7xl font-bold text-dark-grey mx-auto">= 325,000 trees</h2>
                <p class="text-md text-dark-grey mx-2">Amount of CO2e produced by FUHSD in the past year, calculated
                    from energy bill data</p>
            </div>
            <!--<a class="text-2xl font-bold underline mt-2 text-green" href="#">Learn more</a>-->
        </div>
        <div class="w-1/4 mx-auto my-auto"> <!--homes-->
            <div class="mb-8">
                <h2 class="text-7xl font-bold text-dark-grey mx-auto">= 645 homes</h2>
                <p class="text-md text-dark-grey mx-2">Amount of CO2e produced by FUHSD in the past year, calculated
                    from energy bill data</p>
            </div>
            <!--<a class="text-2xl font-bold underline mt-2 text-green" href="#">Learn more</a>-->
        </div>
    </div>

    <!-- Energy Bar Chart Section -->
    <div id="energy-bar-chart-section" class="flex flex-row section reveal">
        <div class="w-7/12 mx-auto">
            <canvas id="energyBarChart"></canvas>
        </div>
        <div class="w-1/3 mx-auto my-auto">
            <h2 class="text-5xl font-bold text-dark-grey mx-auto mb-4">Where does our energy come from?</h2>
            <p class="text-xl text-dark-grey my-3">Understanding the sources of our energy is crucial for making
                informed decisions about our consumption and sustainability practices. By knowing the origins of our
                energy, we can better appreciate the environmental impacts of our choices. </p>
            <!--<a class="text-2xl font-bold underline mt-2 text-green" href="#">Learn more</a>-->
        </div>
    </div>

    <!-- CO2 Emissions Chart Section -->
    <div id="co2-chart-section" class="flex flex-row section reveal">
        <div class="w-4/5 mx-auto">
            <h2 class="text-2xl font-bold text-dark-grey my-6">Our CO2e emissions from energy use over time, by school
            </h2>
            <div class="inline-flex">
                <p class="text-l font-medium text-dark-grey my-auto mr-3">Toggle schools:</p>
                <button class="btn bg-grey-700 text-2xl text-light-grey" id="toggleMontaVista">MVHS</button>
                <button class="btn bg-grey-700 text-2xl text-light-grey" id="toggleHomestead">HHS</button>
                <button class="btn bg-grey-700 text-2xl text-light-grey" id="toggleCupertino">CHS</button>
                <button class="btn bg-grey-700 text-2xl text-light-grey" id="toggleFremont">FHS</button>
                <button class="btn bg-grey-700 text-2xl text-light-grey" id="toggleLynbrook">LHS</button>
                <button class="btn bg-grey-700 text-2xl text-light-grey" id="toggleDistrictOffice">District-Office</button>

            </div>
            <canvas id="co2Chart"></canvas>
        </div>
        <div class="w-1/5 ml-5 text-lg text-dark-grey">This chart tracks the CO2e emissions from each school over time.
            By toggling different schools, you can see how each one contributes to the overall emissions and identify
            patterns or trends that may inform future energy policies.</div>
    </div>

    <!-- Usage Chart Section -->
    <div id="usage-chart-section" class="section reveal">
        <div class="flex flex-row">
            <div class="w-1/3 m-auto">
                <h2 class="text-2xl font-bold text-dark-grey">Where does our footprint come from?</h2>
                <p class="text-dark-grey text-xl">Our carbon footprint is influenced by several factors, including HVAC,
                    lighting, and electric vehicle charging. Understanding the distribution of these sources helps us
                    target areas for improvement and reduce our overall impact.</p>
            </div>
            <div class="w-5/12 m-auto">
                <canvas id="usageChart"></canvas>
            </div>
        </div>
    </div>

    <div id="ev-section" class="flex flex-row mx-20 mb-20 space-x-6 reveal">
        <div id="ev_sliders" class="m-auto w-1/2">
            <h2 class="my-5 font-medium text-2xl text-blue-600">Number of EV chargers: <span id="charger_label"></span></h2>
            <input id="charger_slider" type="range" min="4" max="20" value="6" class="range w-2/3" oninput="recalculate_metrics()"/> <!--arbitrary default for right now-->
            <p class="text-3xl" id="lightning_icontainer">&#9889;&#9889;</p>
            <h2 class="font-medium my-5 text-2xl text-blue-600">Hours occupied: <span id="hours_label"></span></h2>
            <input id="occupancy_slider" type="range" min="0" max="24" value="8" class="range w-2/3" oninput="recalculate_metrics()" />
            <p class="text-3xl" id="clock_icontainer"></p>
        </div>
        <div class="w-7/12">
            <article class="prose">
                <h1 class="text-dark-grey">Our path forward: <span class="text-orange-400">electrification</span></h1>
                <p class="text-dark-grey">By incentivizing EV usage in students and staff, FUHSD is able to cut down on vehicle emissions.</p>
                <h3 class="font-bold text-dark-grey">Slide the charger and occupancy sliders to see how our EV infrastructure is making a difference!</h3>
                <p class="text-2xl font-semibold text-dark-grey">Energy provided: <span id="kwh_produced"></span>kWh</p>
                <p class="text-5xl font-bold text-green">GHGs avoided: <span id="ghgs_avoided"></span>lbs</p>
            </article>
        </div>
    </div>


    <footer class="footer bg-base-200 text-base-content p-10">
        <aside>
            <svg width="50" height="50" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd"
                clip-rule="evenodd" class="fill-current">
                <path
                    d="M22.672 15.226l-2.432.811.841 2.515c.33 1.019-.209 2.127-1.23 2.456-1.15.325-2.148-.321-2.463-1.226l-.84-2.518-5.013 1.677.84 2.517c.391 1.203-.434 2.542-1.831 2.542-.88 0-1.601-.564-1.86-1.314l-.842-2.516-2.431.809c-1.135.328-2.145-.317-2.463-1.229-.329-1.018.211-2.127 1.231-2.456l2.432-.809-1.621-4.823-2.432.808c-1.355.384-2.558-.59-2.558-1.839 0-.817.509-1.582 1.327-1.846l2.433-.809-.842-2.515c-.33-1.02.211-2.129 1.232-2.458 1.02-.329 2.13.209 2.461 1.229l.842 2.515 5.011-1.677-.839-2.517c-.403-1.238.484-2.553 1.843-2.553.819 0 1.585.509 1.85 1.326l.841 2.517 2.431-.81c1.02-.33 2.131.211 2.461 1.229.332 1.018-.21 2.126-1.23 2.456l-2.433.809 1.622 4.823 2.433-.809c1.242-.401 2.557.484 2.557 1.838 0 .819-.51 1.583-1.328 1.847m-8.992-6.428l-5.01 1.675 1.619 4.828 5.011-1.674-1.62-4.829z">
                </path>
            </svg>
            <p>FUHSD<br />Committed to serving students</p>
        </aside>
        <nav>
            <h6 class="footer-title">District</h6>
            <a class="link link-hover text-dark-grey">About us</a>
            <a class="link link-hover text-dark-grey">Contact</a>
            <a class="link link-hover text-dark-grey">Jobs</a>
        </nav>
        <nav>
            <h6 class="footer-title">Legal</h6>
            <a class="link link-hover text-dark-grey">Terms of use</a>
            <a class="link link-hover text-dark-grey">Privacy policy</a>
            <a class="link link-hover text-dark-grey">Cookie policy</a>
        </nav>
    </footer>
    <script>
        // functions for EV interactive (scaffolding for now, will get numbers & update)
        function recalculate_metrics(){
            var numChargers = document.getElementById('charger_slider').value
            document.getElementById("charger_label").innerHTML = numChargers;
            numChargers = Number(numChargers);
            updateChargerIcons(numChargers);
            var occupiedHours = (document.getElementById('occupancy_slider').value)
            document.getElementById("hours_label").innerHTML = occupiedHours;
            occupiedHours = Number(occupiedHours)
            updateClockIcons(occupiedHours);
            var kwhval = numChargers + occupiedHours; //TODO: add EV to KWH formula
            var ghgval = numChargers - occupiedHours; //TODO: add KWH to GHG formula
            update_ev_numbers(kwhval, ghgval)
        }

        function updateChargerIcons(num){
            var n = Number(num)/4 //extra cast just in case
            var parent_div = document.getElementById('lightning_icontainer');
            parent_div.textContent = ""; // clear the icons
            for (let i=0;i<n;i++){
                parent_div.innerHTML += "&#9889;"
            }
        }

        function updateClockIcons(num){
            var n = Number(num)/4 //extra cast just in case
            var parent_div = document.getElementById('clock_icontainer');
            parent_div.textContent = ""; // clear the icons
            for (let i=0;i<n;i++){
                parent_div.innerHTML += "&#128336;"
            }
        }

        function update_ev_numbers(kwh, ghgs){
            document.getElementById('kwh_produced').innerHTML = kwh;
            document.getElementById('ghgs_avoided').innerHTML = ghgs;
        }
        


        document.addEventListener('DOMContentLoaded', function () {
            const lottieAnimation = lottie.loadAnimation({
                container: document.getElementById('lottieThermometer'),
                renderer: 'svg',
                loop: false,
                autoplay: true,
                path: 'https://lottie.host/c16fd91e-2419-4eb1-9540-bb352913bd6c/x92LxRS0s8.json'
            });
    
            let isSummer = false;
            let temperature = 68;
            let startY = 0;
            let moving = false;
    
            // Constants
            const CO2_PER_TREE_YEARLY = 21.77209; // CO2 offset per tree in kg per year
    
            // HVAC Emissions data per temperature
            const hvacEmissionsPerTemp = {
                summer: {
                    68: { emissions: 2_334_600, trees_required: 107_274 },
                    69: { emissions: 2_546_837, trees_required: 116_928 },
                    70: { emissions: 2_759_073, trees_required: 126_582 },
                    71: { emissions: 2_971_310, trees_required: 136_236 },
                    72: { emissions: 3_183_546, trees_required: 145_890 }
                },
                winter: {
                    68: { emissions: 2_334_600, trees_required: 107_274 },
                    69: { emissions: 2_122_363, trees_required: 97_620 },
                    70: { emissions: 1_910_126, trees_required: 87_966 },
                    71: { emissions: 1_697_888, trees_required: 78_312 },
                    72: { emissions: 1_485_651, trees_required: 68_658 }
                }
            };
    
            function updateTemperatureDisplay() {
                document.getElementById('temperatureDisplay').textContent = `Temperature: ${temperature}°F`;
                const optimalTemp = isSummer ? 72 : 68;
                const currentEmissions = hvacEmissionsPerTemp[isSummer ? 'summer' : 'winter'][temperature].emissions;
                const baseEmissions = hvacEmissionsPerTemp[isSummer ? 'summer' : 'winter'][optimalTemp].emissions;
                const extraCO2 = Math.abs(currentEmissions - baseEmissions);
                const treesRequired = Math.round((extraCO2 / CO2_PER_TREE_YEARLY) / 100) * 100; // Rounded to the nearest hundred
                document.getElementById('co2Impact').textContent = `Trees Saved: ${treesRequired.toLocaleString()}`;
                const frame = mapTemperatureToFrame(temperature);
                lottieAnimation.goToAndStop(frame, true);
            }
    
            function mapTemperatureToFrame(temp) {
                if (isSummer) {
                    return 16 + (72 - temp) * 3;
                } else {
                    return (temp - 68) * 4;
                }
            }
    
            const thermometer = document.getElementById('lottieThermometer');
            thermometer.addEventListener('mousedown', function (event) {
                startY = event.clientY;
                moving = true;
                event.preventDefault();
            });
    
            document.addEventListener('mousemove', function (event) {
                if (moving) {
                    const diff = startY - event.clientY;
                    const tempChange = Math.sign(diff) * (Math.abs(diff) > 30 ? 1 : 0);
                    if (tempChange != 0) {
                        temperature = Math.min(Math.max(temperature + tempChange, 68), 72);
                        startY = event.clientY;
                        updateTemperatureDisplay();
                    }
                }
            });
    
            document.addEventListener('mouseup', function () {
                moving = false;
            });
    
            document.getElementById('switchSeason').textContent = 'Switch to Summer';
            document.getElementById('switchSeason').addEventListener('click', function () {
                isSummer = !isSummer;
                temperature = isSummer ? 72 : 68;
                this.textContent = isSummer ? 'Switch to Winter' : 'Switch to Summer';
                updateTemperatureDisplay();
            });
    
            updateTemperatureDisplay();
        });

        document.addEventListener('DOMContentLoaded', function () {

            const montaVistaData = [
        		{ "Date": "01/31/2023", "C02 Emissions": 727663.36 },
        		{ "Date": "02/28/2023", "C02 Emissions": 587880.11 },
        		{ "Date": "03/31/2023", "C02 Emissions": 573896.29 },
        		{ "Date": "04/30/2023", "C02 Emissions": 358956.79 },
        		{ "Date": "05/31/2023", "C02 Emissions": 154547.06 },
        		{ "Date": "06/30/2023", "C02 Emissions": 44783.33 },
        		{ "Date": "07/31/2023", "C02 Emissions": 59512.29 },
        		{ "Date": "08/31/2023", "C02 Emissions": 69921.89 },
        		{ "Date": "09/30/2023", "C02 Emissions": 90718.94 },
        		{ "Date": "10/31/2023", "C02 Emissions": 175833.46 },
        		{ "Date": "11/30/2023", "C02 Emissions": 191784.22 },
        		{ "Date": "12/31/2023", "C02 Emissions": 246212.81 }
            ];

            const homesteadData = [
        		{ "Date": "01/31/2023", "C02 Emissions": 132923.78 },
        		{ "Date": "02/28/2023", "C02 Emissions": 127939.64 },
        		{ "Date": "03/31/2023", "C02 Emissions": 137513.42 },
        		{ "Date": "04/30/2023", "C02 Emissions": 102474.1 },
        		{ "Date": "05/31/2023", "C02 Emissions": 83268.44 },
        		{ "Date": "06/30/2023", "C02 Emissions": 48221.93 },
        		{ "Date": "07/31/2023", "C02 Emissions": 52872.79 },
        		{ "Date": "08/31/2023", "C02 Emissions": 74645.42 },
        		{ "Date": "09/30/2023", "C02 Emissions": 91089.36 },
        		{ "Date": "10/31/2023", "C02 Emissions": 113818.21 },
        		{ "Date": "11/30/2023", "C02 Emissions": 126739.71 },
        		{ "Date": "12/31/2023", "C02 Emissions": 152030.9 }

            ];

            const cupertinoData = [
        		{ "Date": "01/31/2023", "C02 Emissions": 156286.17 },
        		{ "Date": "02/28/2023", "C02 Emissions": 145493.98 },
        		{ "Date": "03/31/2023", "C02 Emissions": 143237.41 },
        		{ "Date": "04/30/2023", "C02 Emissions": 97328.6 },
        		{ "Date": "05/31/2023", "C02 Emissions": 68645.79 },
        		{ "Date": "06/30/2023", "C02 Emissions": 47458.04 },
        		{ "Date": "07/31/2023", "C02 Emissions": 42151.74 },
        		{ "Date": "08/31/2023", "C02 Emissions": 50443.55 },
        		{ "Date": "09/30/2023", "C02 Emissions": 63081.93 },
        		{ "Date": "10/31/2023", "C02 Emissions": 83932.38 },
        		{ "Date": "11/30/2023", "C02 Emissions": 106665.92 },
        		{ "Date": "12/31/2023", "C02 Emissions": 133513.46 }

            ];

            const districtOfficeData = [
                { "Date": " 1/19/2023", "CO2 Emissions": 27959.88 },
                { "Date": " 2/17/2023", "CO2 Emissions": 27975.51 },
                { "Date": " 3/21/2023", "CO2 Emissions": 27432.24 },
                { "Date": " 4/20/2023", "CO2 Emissions": 24070.26 },
                { "Date": " 5/19/2023", "CO2 Emissions": 19851.54 },
                { "Date": " 6/20/2023", "CO2 Emissions": 17866.35 }
            ];


            const fremontData = [
        		{ "Date": "01/31/2023", "C02 Emissions": 28241.43 },
        		{ "Date": "02/28/2023", "C02 Emissions": 25660.15 },
        		{ "Date": "03/31/2023", "C02 Emissions": 25946.79 },
        		{ "Date": "04/30/2023", "C02 Emissions": 22745.67 },
        		{ "Date": "05/31/2023", "C02 Emissions": 20082.7 },
        		{ "Date": "06/30/2023", "C02 Emissions": 17901.61 },
        		{ "Date": "07/31/2023", "C02 Emissions": 17899.15 },
        		{ "Date": "08/31/2023", "C02 Emissions": 18542.75 },
        		{ "Date": "09/30/2023", "C02 Emissions": 20967.47 },
        		{ "Date": "10/31/2023", "C02 Emissions": 22372.98 },
        		{ "Date": "11/30/2023", "C02 Emissions": 21703.19 },
        		{ "Date": "12/31/2023", "C02 Emissions": 24342.24 }

            ];

            const lynbrookData = [
                { "Date": "01/31/2023", "C02 Emissions": 135196.38 },
                { "Date": "02/28/2023", "C02 Emissions": 121571.47 },
                { "Date": "03/31/2023", "C02 Emissions": 133644.29 },
                { "Date": "04/30/2023", "C02 Emissions": 100559.22 },
                { "Date": "05/31/2023", "C02 Emissions": 70134.48 },
                { "Date": "06/30/2023", "C02 Emissions": 40832.97 },
                { "Date": "07/31/2023", "C02 Emissions": 22937.5 },
                { "Date": "08/31/2023", "C02 Emissions": 54074.85 },
                { "Date": "09/30/2023", "C02 Emissions": 73146.53 },
                { "Date": "10/31/2023", "C02 Emissions": 82974.61 },
                { "Date": "11/30/2023", "C02 Emissions": 73843.52 },
                { "Date": "12/31/2023", "C02 Emissions": 90581.76 }
            ];

            let labels = montaVistaData.map(data => data['Date'].trim());
            let montaVistaEmissions = montaVistaData.map(data => data['C02 Emissions']);
            let homesteadEmissions = homesteadData.map(data => data['C02 Emissions']);
            let cupertinoEmissions = cupertinoData.map(data => data['C02 Emissions']);
            let fremontEmissions = fremontData.map(data => data['C02 Emissions']);
            let lynbrookEmissions = lynbrookData.map(data => data['C02 Emissions']);
            let districtOfficeEmissions = districtOfficeData.map(data => data['CO2 Emissions']);


            let ctx = document.getElementById('co2Chart').getContext('2d');
            let co2Chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        { label: 'MVHS', data: montaVistaEmissions, borderColor: '#2e7d32', backgroundColor: '#2e7d32', hidden: false },
                        { label: 'HHS', data: homesteadEmissions, borderColor: '#8e24aa', backgroundColor: '#8e24aa', hidden: true },
                        { label: 'Cupertino', data: cupertinoEmissions, borderColor: '#f39c12', backgroundColor: '#f39c12', hidden: true },
                        { label: 'Fremont', data: fremontEmissions, borderColor: '#e74c3c', backgroundColor: '#e74c3c', hidden: true },
                        { label: 'Lynbrook', data: lynbrookEmissions, borderColor: '#ffc0cb', backgroundColor: '#ffc0cb', hidden: true },
                        { label: 'District Office', data: districtOfficeEmissions, borderColor: '#3498db', backgroundColor: '#3498db', hidden: true }

                    ]
                },
                options: {
                    plugins: {
                        legend: {
                            display: true,
                            onClick: null
                        },
                        title: {
                            display: false,
                            font: {
                                size: 30
                            },
                            text: 'CO2e emissions, by school'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
            document.getElementById('toggleMontaVista').classList.toggle('bg-emerald-300');
            document.getElementById('toggleMontaVista').addEventListener('click', function () {
                this.classList.toggle('bg-emerald-300');
                toggleDataset(co2Chart, 'MVHS');
            });

            document.getElementById('toggleHomestead').addEventListener('click', function () {
                this.classList.toggle('bg-violet-200');
                toggleDataset(co2Chart, 'HHS');
            });

            document.getElementById('toggleCupertino').addEventListener('click', function () {
                this.classList.toggle('bg-orange-300');
                toggleDataset(co2Chart, 'Cupertino');
            });

            document.getElementById('toggleFremont').addEventListener('click', function () {
                this.classList.toggle('bg-red-300');
                toggleDataset(co2Chart, 'Fremont');
            });

            document.getElementById('toggleLynbrook').addEventListener('click', function () {
                this.classList.toggle('bg-purple-300');
                toggleDataset(co2Chart, 'Lynbrook');
            });
            document.getElementById('toggleDistrictOffice').addEventListener('click', function () {
                this.classList.toggle('bg-blue-300');
                toggleDataset(co2Chart, 'District Office');
            });


            function toggleDataset(chart, label) {
                const dataset = chart.data.datasets.find(d => d.label === label);
                dataset.hidden = !dataset.hidden;
                chart.update();
            }
        });

        document.addEventListener('DOMContentLoaded', function () {
            const bar_data = [
                { category: 'Monta Vista', kwh: 70, color: '#2e7d32' },
                { category: 'Homestead', kwh: 40, color: '#8e24aa' },
                { category: 'Lynbrook', kwh: 50, color: '#ffc0cb' },
                { category: 'Cupertino', kwh: 30, color: '#f39c12' },
                { category: 'Fremont', kwh: 36, color: '#e74c3c' }
            ];

            let ctx2 = document.getElementById('energyBarChart').getContext('2d');
            new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: bar_data.map(row => row.category),
                    datasets: [{
                        label: 'kWh used, by school',
                        data: bar_data.map(row => row.kwh),
                        backgroundColor: bar_data.map(row => row.color)
                    }]
                },
                options: {
                    indexAxis: 'y',
                    plugins: {
                        legend: {
                            labels: {
                                font: {
                                    size: 14
                                }
                            }
                        }
                    }
                }
            });


            let ctx3 = document.getElementById('usageChart').getContext('2d');
            new Chart(ctx3, {
                type: 'pie',
                data: {
                    labels: ["HVAC", "Lighting", "Computers/Electronics", "Water heating", "Food preparation & storage", "Other"],
                    datasets: [{
                        label: "Percentage:",
                        backgroundColor: ['#2e7d32','#8e24aa','#f39c12','#e74c3c','#ffc0cb', '#599cff'],
                        data: [33.3, 25.5, 9.5, 12.3, 6.1, 13.2]
                        // refrigeration & cooking combined, same for computers & electronics, and 5.5 put into water heating because we have pools!
                        // we really need to consider replacing/removing this feature unless we can get some better data :(
                    }]
                },
                options: {
                    plugins: {
                        legend: {
                            labels: {
                                font: {
                                    size: 14
                                }
                            }
                        }
                    }
                }
            });
        });

        const reveals = document.querySelectorAll(".reveal");

        function reveal() {
            for (let i = 0; i < reveals.length; i++) {
                const windowHeight = window.innerHeight;
                const elementTop = reveals[i].getBoundingClientRect().top;
                const elementVisible = 150;

                if (elementTop < windowHeight - elementVisible) {
                    reveals[i].classList.add("active");
                } else {
                    reveals[i].classList.remove("active");
                }
            }
        }

        window.addEventListener("scroll", reveal);

        reveal();
        
        function scrollDown(wait_time){
            const mainTitle = document.getElementById('main-title');
            const staticTitle = document.getElementById('static-title');
            setTimeout(() => {
                window.scrollBy({ top: window.innerHeight, behavior: 'smooth' });
            }, wait_time);
            window.addEventListener('scroll', function () {
                if (window.scrollY > window.innerHeight) {
                    staticTitle.classList.add('visible');
                    mainTitle.style.display = 'none';
                } else {
                    staticTitle.classList.remove('visible');
                    mainTitle.style.display = 'block';
                }
            });
        }

        // Auto scroll and fade-out animation for the main title
        window.addEventListener('load', scrollDown(1000));

        // Show navbar once scrolled to the bottom
        window.addEventListener('scroll', function () {
            const navbar = document.getElementById('navbar');
            if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight) {
                navbar.classList.add('visible');
            }
        });

    </script>
</body>

</html>
