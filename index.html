<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Energy Consumption Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.7.4/lottie.min.js"></script>
    <script src="https://unpkg.com/@lottiefiles/lottie-interactivity@latest/dist/lottie-interactivity.min.js"></script>

    <style>
        html {
            scroll-behavior: smooth;
        }

        body {
            background-color: #f5f5f7;
            color: #333;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }

        .reveal {
            opacity: 0;
            transform: translateY(100px);
            transition: all 0.6s ease-in-out;
        }

        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }

        .fade-in {
            animation: fadeIn 2s forwards;
        }

        @keyframes fadeIn {
            0% {
                opacity: 0;
            }

            100% {
                opacity: 1;
            }
        }

        .fade-out {
            animation: fadeOut 3s forwards;
        }

        @keyframes fadeOut {
            0% {
                opacity: 1;
            }

            100% {
                opacity: 0;
            }
        }

        .arrow {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2rem;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%,
            20%,
            50%,
            80%,
            100% {
                transform: translateX(-50%) translateY(0);
            }

            40% {
                transform: translateX(-50%) translateY(-10px);
            }

            60% {
                transform: translateX(-50%) translateY(-5px);
            }
        }

        .section {
            margin: 11rem 5rem;
        }

        .bg-light-grey {
            background-color: #e0e0e0;
        }

        .text-dark-grey {
            color: #333;
        }

        .text-green {
            color: #2e7d32;
        }

        .text-9xl {
            font-size: 7rem;
        }

        .text-5xl {
            font-size: 4rem;
        }

        .text-2xl {
            font-size: 2rem;
        }

        .static-title {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2rem;
            font-weight: bold;
            display: none;
            color: #2e7d32;
        }

        .visible {
            display: block;
        }

        .navbar {
            background-color: #f5f5f7;
            color: #2e7d32;
            font-weight: bold;
            padding: 1rem;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            display: none;
        }

        .navbar.visible {
            display: flex;
            justify-content: center;
            gap: 1rem;
        }

        .nav-link {
            color: #2e7d32;
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* Override DaisyUI's dark mode */
        :root {
            --btn-text-color: #333;
            --btn-bg-color: #f5f5f7;
            --btn-border-color: #ddd;
        }

        .btn {
            color: var(--btn-text-color);
            background-color: var(--btn-bg-color);
            border-color: var(--btn-border-color);
        }

        /* Responsive design */
        @media (max-width: 1024px) {
            .section {
                margin: 6rem 2rem;
            }
        }

        @media (max-width: 768px) {
            .section {
                margin: 3rem 1rem;
            }

            .navbar {
                flex-direction: column;
                gap: 0.5rem;
            }

            .hero-content h1 {
                font-size: 4rem;
            }

            .hero-content p {
                font-size: 1rem;
            }
        }

        /* Quick Stats Section */
        .quick-stats-wrapper {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 2rem; 
            margin-bottom: 2rem;
        }

        .stat-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 50%;
        }

        .stat-title {
            font-size: 3.5rem; 
            font-weight: bold; 
            margin-bottom: 0.5rem;
            display: flex;
            justify-content: center;
            align-items: center;
            color: black
        }

        .stat-text {
            text-align: center;
            font-size: 1rem;
            margin-top: 0.5rem;
        }

        .stat-description {
            font-size: 1.25rem;
            font-weight: 500; 
            text-align: center;
            color: #555; 
            margin-top: 0.5rem;
        }

        .quick-stats-wrapper {
            display: flex;
            justify-content: space-evenly;
            align-items: center;
            width: 100%;
        }

        /* Styles for Thermostat Widget */
        .thermostat-widget {
            display: flex;
            justify-content: center;
            flex-direction: column;
        }
    </style>
</head>

<body>
    <!-- Navigation Bar -->
    <nav id="navbar" class="navbar">
        <a class="nav-link" href="#hvac-section">HVAC</a>
        <a class="nav-link" href="#quick-stats-section">Quick Stats</a>
        <a class="nav-link" href="#energy-bar-chart-section">Energy Bar Chart</a>
        <a class="nav-link" href="#co2-chart-section">CO2 Emissions</a>
        <a class="nav-link" href="#usage-chart-section">Usage Chart</a>
    </nav>

    <!-- Big Heading -->
    <div class="hero min-h-screen" style="background-image: url(https://cdn.prod.website-files.com/64ef69890f8c25d119ae1fb4/6514ab39f4d82d4ed88bbf0f_Lead-Image-jpg.webp);">
        <div class="hero-overlay bg-opacity-70 backdrop-grayscale bg-green-900"></div>
        <div class="hero-content text-center">
            <div class="max-w-lg text-white">
                <h1 class="text-6xl font-bold">FUHSD Sustainability Data Dashboard</h1>
                <p class="py-6 text-md font-medium">
                    This is a snapshot of FUHSD's environmental impact, analyzing real FUHSD data for the <span class="font-black">2022-2023</span> school year. Scroll through to find interactives, dynamic charts, and visualizations of where we are as a district.
                </p>
                <button class="btn btn-primary" onclick="scrollDown(5)">Get Started</button>
            </div>
        </div>
        <div class="arrow text-white">â†“</div>
    </div>

    <div id="static-title" class="static-title">FUHSD Sustainability</div>

    <!-- HVAC Section -->
    <div id="hvac-section" class="section thermostat-container flex flex-row mx-20 my-10 space-x-6 reveal hvac-section">
        <div class="w-7/12">
            <article class="prose">
                <h1 class="text-dark-grey">HVAC is responsible for <span class="text-green">40%</span> of our energy usage.</h1>
                <p class="text-dark-grey">One degree adjustment in HVAC can save energy equivalent to saving thousands of trees.</p>
                <h3 class="font-bold text-dark-grey">Slide the thermometer up or down a few notches to see its carbon impact!</h3>
                <p id="temperatureDisplay" class="text-2xl font-semibold text-dark-grey">Temperature: 72Â°F</p>
                <p id="co2Impact" class="text-5xl font-bold text-green thermostat-widget">Trees saved: 0 ðŸŒ³</p>
                <button class="btn text-dark-grey text-2xl font-bold" id="switchSeason">Switch to Winter</button>
            </article>
        </div>
        <div class="thermostat-animation rounded-md" id="thermo-background">
            <div class="my-14" id="lottieThermometer"></div>
        </div>
    </div>

    <!-- Quick Stats Section -->
    <div class="section">
        <article class="prose mx-auto my-10 stat-section">
            <h2 class="text-dark-grey text-center">Some quick stats:</h2>
            <p class="text-md text-dark-grey mx-2 text-center">These calculations and widgets are based on actual FUHSD data</p>
        </article>
        <div id="quick-stats-section" class="flex flex-row reveal quick-stat-title">
            <div class="quick-stats-wrapper">
                <div class="stat-container">
                    <h2 class="stat-title">7,075 <span>mt*</span></h2>
                    <p class="stat-description">Amount of COâ‚‚e produced by FUHSD in the <span class="font-bold">past year</span>, calculated from energy bill data.</p>
                    <p class="stat-text">The data gathered from our energy bills indicates our current consumption trends and areas where we can improve.</p>
                </div>
                <div class="stat-container">
                    <h2 class="stat-title">= 325,000 trees ðŸŒ³</h2>
                    <p class="stat-text">Emissions produced by FUHSD in the past year, represented in trees required to offset emissions.</p>
                </div>
            </div>
        </div>
        <p class="text-md text-dark-grey mx-2 text-center mt-8">*mt: Metric Tons, a unit of mass equal to 1,000 kilograms.</p>
    </div>

    <!-- Energy Bar Chart Section -->
    <div id="energy-bar-chart-section" class="flex flex-row section reveal">
        <div class="w-7/12 mx-auto">
            <canvas id="energyBarChart"></canvas>
        </div>
        <div class="w-1/3 mx-auto my-auto">
            <h2 class="text-5xl font-bold text-dark-grey mx-auto mb-4">Where does our energy come from?</h2>
            <p class="text-xl text-dark-grey my-3">Understanding the sources of our energy is crucial for making informed decisions about our consumption and sustainability practices. By knowing the origins of our energy, we can better appreciate the environmental impacts of our choices.</p>
        </div>
    </div>

    <!-- CO2 Emissions Chart Section -->
    <div class="section">
        <div id="co2-chart-section" class="flex flex-row reveal m-20">
            <div class="w-4/5 mx-auto">
                <article class="prose">
                    <h1 class="my-8">Our impact, over time</h1>
                </article>
                <div class="inline-flex space-x-3">
                    <p class="text-l font-medium text-dark-grey my-auto mr-3">Toggle schools:</p>
                    <button class="btn text-xl" id="toggleMontaVista">MVHS</button>
                    <button class="btn text-xl" id="toggleHomestead">HHS</button>
                    <button class="btn text-xl" id="toggleCupertino">CHS</button>
                    <button class="btn text-xl" id="toggleFremont">FHS</button>
                    <button class="btn text-xl" id="toggleLynbrook">LHS</button>
                    <button class="btn text-xl" id="toggleDistrictOffice">District-Office</button>
                </div>
                <canvas id="co2Chart"></canvas>
            </div>
            <div class="w-1/5 ml-5 text-lg text-dark-grey my-auto">
                This chart tracks energy consumption (both gas and electric) in terms of carbon dioxide emissions. By toggling different schools, you can identify patterns and trends.<br/><br/>
                Emissions typically drop during the summer, and rise again in the winter. This is likely due to the extensive use of heating mechanisms in the school during winter. <br/>
                You may notice that Monta Vista's emissions are exceptionally high. This is largely due to the inefficiency of the pool heating system at Monta Vista, which works year round. 
            </div>
        </div>
    </div>

    <!-- Usage Chart Section -->
    <div id="usage-chart-section" class="section reveal">
        <div class="flex flex-row">
            <div class="w-1/3 mx-20 my-auto">
                <h2 class="text-2xl font-bold text-dark-grey">Where does our footprint come from? <span class="text-lg font-light">*</span></h2>
                <p class="text-dark-grey text-xl">Our carbon footprint is influenced by several factors, including HVAC, lighting, and electric vehicle charging. Understanding the distribution of these sources helps us target areas for improvement and reduce our overall impact.</p>
                <small class="font-medium">*Closest estimates, based on regionally-adjusted national data</small>
            </div>
            <div class="w-5/12 m-auto">
                <canvas id="usageChart"></canvas>
            </div>
        </div>
    </div>

    <div id="ev-section" class="flex flex-row mx-20 mb-40 space-x-6 section reveal">
        <div id="ev_sliders" class="m-auto w-1/2">
            <h2 class="my-5 font-medium text-2xl text-blue-600">Number of EV chargers: <span id="charger_label">120</span></h2>
            <input id="charger_slider" type="range" min="0" max="270" value="120" step="30" class="range w-2/3" oninput="recalculate_metrics()" />
            <p class="text-3xl" id="lightning_icontainer">&#9889;&#9889;</p>
            <h2 class="font-medium my-5 text-2xl text-blue-600">Hours occupied: <span id="hours_label">5</span></h2>
            <input id="occupancy_slider" type="range" min="0" max="10" value="5" class="range w-2/3" oninput="recalculate_metrics()" />
            <p class="text-3xl" id="clock_icontainer"></p>
        </div>
        <div class="w-7/12">
            <article class="prose">
                <h1 class="text-dark-grey">Our path forward: <span class="text-orange-400">electrification</span></h1>
                <p class="text-dark-grey">By incentivizing EV usage in students and staff, FUHSD is able to cut down on vehicle emissions. We currently have <strong>~ 200</strong> chargers across all our high school sites, and the average occupancy for each is <strong>~ 5</strong> hours.</p>
                <h3 class="font-bold text-dark-grey">Slide the charger and occupancy sliders to see how our EV infrastructure is making a difference!</h3>
                <p class="text-2xl font-semibold text-dark-grey">Energy provided: <span id="kwh_produced">1,617</span>kWh</p>
                <p class="text-5xl font-bold text-green">GHGs avoided: <br><span id="ghgs_avoided">2,578</span>lbs daily &#9728;</p>
                <p class="text-5xl font-bold text-green">In a single year, that's<br>~<span id="ev_tree_equivalent">3,376</span> trees &#127794;</p>
            </article>
        </div>
    </div>

    <footer class="footer bg-black text-off-white p-10">
        <aside class="flex items-center space-x-4">
            <img src="large-logo.png" alt="FUHSD Logo" class="w-16 h-auto">
            <p>FUHSD<br />Committed to serving students</p>
        </aside>
        <nav>
            <h6 class="footer-title">District</h6>
            <a class="link link-hover text-off-white" href="https://www.fuhsd.org" target="_blank">About FUHSD</a>
            <a class="link link-hover text-off-white" href="contact.html">Contact</a>
        </nav>
        <nav>
            <h6 class="footer-title">Legal</h6>
            <a class="link link-hover text-off-white" href="terms-of-service.html">Terms of Service</a>
            <a class="link link-hover text-off-white" href="privacy-policy.html">Privacy Policy</a>
            <a class="link link-hover text-off-white" href="cookie-policy.html">Cookie Policy</a>
        </nav>
        <div class="made-with-love text-center mt-4">
            <p class="text-white">
                Made with <span class="heart">â™¡</span> by 
                <a href="https://www.linkedin.com/in/hursh-shah-5529b4262/" class="text-green-500 hover:text-green-300" target="_blank">Hursh Shah</a>,
                <a href="https://www.linkedin.com/in/purva-marfatia-b0486518b/" class="text-green-500 hover:text-green-300" target="_blank">Purva Marfatia</a>,
                and Ronith Chikkaballapur
            </p>
        </div>
    </footer>
    <script>
        // Functions for EV interactive
        function recalculate_metrics() {
            var numChargers = document.getElementById('charger_slider').value
            document.getElementById("charger_label").innerHTML = numChargers;
            numChargers = Number(numChargers);
            updateChargerIcons(numChargers);
            var occupiedHours = (document.getElementById('occupancy_slider').value)
            document.getElementById("hours_label").innerHTML = occupiedHours;
            occupiedHours = Number(occupiedHours)
            updateClockIcons(occupiedHours);
            var kwhval = numChargers * occupiedHours * Number(2.695); // TODO: add EV to KWH formula
            var ghgval = kwhval * 1.79 * 2204.62 * 0.000404; // TODO: add KWH to GHG formula
            var treeval = kwhval * 0.0116 * 180
            update_ev_numbers(kwhval, ghgval, treeval)
        }

        function updateChargerIcons(num) {
            var n = Number(num) / 30 // extra cast just in case
            var parent_div = document.getElementById('lightning_icontainer');
            parent_div.textContent = ""; // clear the icons
            for (let i = 0; i < n; i++) {
                parent_div.innerHTML += "&#9889;"
            }
        }

        function updateClockIcons(num) {
            var n = Number(num) // extra cast just in case
            var parent_div = document.getElementById('clock_icontainer');
            parent_div.textContent = ""; // clear the icons
            for (let i = 0; i < n; i++) {
                parent_div.innerHTML += "&#128336;"
            }
        }

        function update_ev_numbers(kwh, ghgs, trees) {
            kwh_rounded = Math.round(kwh);
            ghgs_rounded = Math.round(ghgs)
            trees_rounded = Math.round(trees)
            document.getElementById('kwh_produced').innerHTML = kwh_rounded.toLocaleString()
            document.getElementById('ghgs_avoided').innerHTML = ghgs_rounded.toLocaleString()
            document.getElementById('ev_tree_equivalent').innerHTML = trees_rounded.toLocaleString()
        }

        document.addEventListener('DOMContentLoaded', function () {
            const lottieAnimation = lottie.loadAnimation({
                container: document.getElementById('lottieThermometer'),
                renderer: 'svg',
                loop: false,
                autoplay: true,
                path: 'https://lottie.host/c16fd91e-2419-4eb1-9540-bb352913bd6c/x92LxRS0s8.json'
            });

            let isSummer = false;
            let temperature = 68;
            let startY = 0;
            let moving = false;

            // Constants
            const CO2_PER_TREE_YEARLY = 21.77209; // CO2 offset per tree in kg per year

            // HVAC Emissions data per temperature
            const hvacEmissionsPerTemp = {
                summer: {
                    68: { emissions: 2_334_600, trees_required: 107_274 },
                    69: { emissions: 2_546_837, trees_required: 116_928 },
                    70: { emissions: 2_759_073, trees_required: 126_582 },
                    71: { emissions: 2_971_310, trees_required: 136_236 },
                    72: { emissions: 3_183_546, trees_required: 145_890 }
                },
                winter: {
                    68: { emissions: 2_334_600, trees_required: 107_274 },
                    69: { emissions: 2_122_363, trees_required: 97_620 },
                    70: { emissions: 1_910_126, trees_required: 87_966 },
                    71: { emissions: 1_697_888, trees_required: 78_312 },
                    72: { emissions: 1_485_651, trees_required: 68_658 }
                }
            };

            function updateTemperatureDisplay() {
                document.getElementById('temperatureDisplay').textContent = `Temperature: ${temperature}Â°F`;
                const optimalTemp = isSummer ? 72 : 68;
                const currentEmissions = hvacEmissionsPerTemp[isSummer ? 'summer' : 'winter'][temperature].emissions;
                const baseEmissions = hvacEmissionsPerTemp[isSummer ? 'summer' : 'winter'][optimalTemp].emissions;
                const extraCO2 = Math.abs(currentEmissions - baseEmissions);
                const treesRequired = Math.round((extraCO2 / CO2_PER_TREE_YEARLY) / 100) * 100; // Rounded to the nearest hundred
                document.getElementById('co2Impact').textContent = `Trees Saved: ${treesRequired.toLocaleString()} ðŸŒ³`;
                const frame = mapTemperatureToFrame(temperature);
                lottieAnimation.goToAndStop(frame, true);
            }

            function mapTemperatureToFrame(temp) {
                if (isSummer) {
                    return 16 + (72 - temp) * 3;
                } else {
                    return (temp - 68) * 4;
                }
            }

            const thermometer = document.getElementById('lottieThermometer');
            thermometer.addEventListener('mousedown', function (event) {
                startY = event.clientY;
                moving = true;
                event.preventDefault();
            });

            document.addEventListener('mousemove', function (event) {
                if (moving) {
                    const diff = startY - event.clientY;
                    const tempChange = Math.sign(diff) * (Math.abs(diff) > 30 ? 1 : 0);
                    if (tempChange != 0) {
                        temperature = Math.min(Math.max(temperature + tempChange, 68), 72);
                        startY = event.clientY;
                        updateTemperatureDisplay();
                    }
                }
            });

            document.addEventListener('mouseup', function () {
                moving = false;
            });

            document.getElementById('switchSeason').textContent = 'Switch to Summer';
            document.getElementById('switchSeason').addEventListener('click', function () {
                isSummer = !isSummer;
                temperature = isSummer ? 72 : 68;
                this.textContent = isSummer ? 'Switch to Winter' : 'Switch to Summer';
                updateTemperatureDisplay();
            });

            updateTemperatureDisplay();
        });

        document.addEventListener('DOMContentLoaded', function () {
            const montaVistaData = [
                { "Date": "1/31/2022", "COâ‚‚ Emissions": 550468.01 },
                { "Date": "2/28/2022", "COâ‚‚ Emissions": 485215.5 },
                { "Date": "3/31/2022", "COâ‚‚ Emissions": 434654.95 },
                { "Date": "4/30/2022", "COâ‚‚ Emissions": 303880.94 },
                { "Date": "5/31/2022", "COâ‚‚ Emissions": 165546.44 },
                { "Date": "6/30/2022", "COâ‚‚ Emissions": 39386.26 },
                { "Date": "7/31/2022", "COâ‚‚ Emissions": 15603.67 },
                { "Date": "8/31/2022", "COâ‚‚ Emissions": 43796.9 },
                { "Date": "9/30/2022", "COâ‚‚ Emissions": 63648.58 },
                { "Date": "10/31/2022", "COâ‚‚ Emissions": 145321.38 },
                { "Date": "11/30/2022", "COâ‚‚ Emissions": 189162.64 },
                { "Date": "12/31/2022", "COâ‚‚ Emissions": 326650.47 },
                { "Date": "1/31/2023", "COâ‚‚ Emissions": 679090.51 },
                { "Date": "2/28/2023", "COâ‚‚ Emissions": 547373.39 },
                { "Date": "3/31/2023", "COâ‚‚ Emissions": 533814.9 },
                { "Date": "4/30/2023", "COâ‚‚ Emissions": 329312.08 },
                { "Date": "5/31/2023", "COâ‚‚ Emissions": 131473.77 },
                { "Date": "6/30/2023", "COâ‚‚ Emissions": 64822.78 },
                { "Date": "7/31/2023", "COâ‚‚ Emissions": 44075.76 },
                { "Date": "8/31/2023", "COâ‚‚ Emissions": 49977.29 },
                { "Date": "9/30/2023", "COâ‚‚ Emissions": 69808.92 },
                { "Date": "10/31/2023", "COâ‚‚ Emissions": 150911.06 },
                { "Date": "11/30/2023", "COâ‚‚ Emissions": 168686.18 },
                { "Date": "12/31/2023", "COâ‚‚ Emissions": 222113.98 }
            ];
            const cupertinoData = [
                { "Date": "1/31/2022", "COâ‚‚ Emissions": 118836.64 },
                { "Date": "2/28/2022", "COâ‚‚ Emissions": 95103.53 },
                { "Date": "3/31/2022", "COâ‚‚ Emissions": 82400.22 },
                { "Date": "4/30/2022", "COâ‚‚ Emissions": 63914.07 },
                { "Date": "5/31/2022", "COâ‚‚ Emissions": 53777.37 },
                { "Date": "6/30/2022", "COâ‚‚ Emissions": 27871.24 },
                { "Date": "7/31/2022", "COâ‚‚ Emissions": 20428.25 },
                { "Date": "8/31/2022", "COâ‚‚ Emissions": 35282.29 },
                { "Date": "9/30/2022", "COâ‚‚ Emissions": 50434.15 },
                { "Date": "10/31/2022", "COâ‚‚ Emissions": 70553.84 },
                { "Date": "11/30/2022", "COâ‚‚ Emissions": 105501.32 },
                { "Date": "12/31/2022", "COâ‚‚ Emissions": 129687.58 },
                { "Date": "1/31/2023", "COâ‚‚ Emissions": 133100.2 },
                { "Date": "2/28/2023", "COâ‚‚ Emissions": 125385.6 },
                { "Date": "3/31/2023", "COâ‚‚ Emissions": 123546.46 },
                { "Date": "4/30/2023", "COâ‚‚ Emissions": 83589.09 },
                { "Date": "5/31/2023", "COâ‚‚ Emissions": 56112.8 },
                { "Date": "6/30/2023", "COâ‚‚ Emissions": 38169.3 },
                { "Date": "7/31/2023", "COâ‚‚ Emissions": 31697.35 },
                { "Date": "8/31/2023", "COâ‚‚ Emissions": 36028.66 },
                { "Date": "9/30/2023", "COâ‚‚ Emissions": 45773.99 },
                { "Date": "10/31/2023", "COâ‚‚ Emissions": 63766.4 },
                { "Date": "11/30/2023", "COâ‚‚ Emissions": 85550.92 },
                { "Date": "12/31/2023", "COâ‚‚ Emissions": 109831.1 }
            ];
            const homesteadData = [
                { "Date": "1/31/2022", "COâ‚‚ Emissions": 102378.88 },
                { "Date": "2/28/2022", "COâ‚‚ Emissions": 86305.29 },
                { "Date": "3/31/2022", "COâ‚‚ Emissions": 77210.92 },
                { "Date": "4/30/2022", "COâ‚‚ Emissions": 60075.03 },
                { "Date": "5/31/2022", "COâ‚‚ Emissions": 47601.62 },
                { "Date": "6/30/2022", "COâ‚‚ Emissions": 21220.19 },
                { "Date": "7/31/2022", "COâ‚‚ Emissions": 16063.91 },
                { "Date": "8/31/2022", "COâ‚‚ Emissions": 31596.24 },
                { "Date": "9/30/2022", "COâ‚‚ Emissions": 44804.54 },
                { "Date": "10/31/2022", "COâ‚‚ Emissions": 61142.39 },
                { "Date": "11/30/2022", "COâ‚‚ Emissions": 88666.14 },
                { "Date": "12/31/2022", "COâ‚‚ Emissions": 111126.96 },
                { "Date": "1/31/2023", "COâ‚‚ Emissions": 113486.37 },
                { "Date": "2/28/2023", "COâ‚‚ Emissions": 110899.81 },
                { "Date": "3/31/2023", "COâ‚‚ Emissions": 119030.55 },
                { "Date": "4/30/2023", "COâ‚‚ Emissions": 89134.87 },
                { "Date": "5/31/2023", "COâ‚‚ Emissions": 68017.46 },
                { "Date": "6/30/2023", "COâ‚‚ Emissions": 37272.54 },
                { "Date": "7/31/2023", "COâ‚‚ Emissions": 39890.13 },
                { "Date": "8/31/2023", "COâ‚‚ Emissions": 56414.04 },
                { "Date": "9/30/2023", "COâ‚‚ Emissions": 69170.5 },
                { "Date": "10/31/2023", "COâ‚‚ Emissions": 88099.82 },
                { "Date": "11/30/2023", "COâ‚‚ Emissions": 102145.49 },
                { "Date": "12/31/2023", "COâ‚‚ Emissions": 124977.86 }
            ];
            const lynbrookData = [
                { "Date": "1/31/2022", "COâ‚‚ Emissions": 95904.8 },
                { "Date": "2/28/2022", "COâ‚‚ Emissions": 88616.9 },
                { "Date": "3/31/2022", "COâ‚‚ Emissions": 68802.29 },
                { "Date": "4/30/2022", "COâ‚‚ Emissions": 57416.08 },
                { "Date": "5/31/2022", "COâ‚‚ Emissions": 46315.43 },
                { "Date": "6/30/2022", "COâ‚‚ Emissions": 17272.64 },
                { "Date": "7/31/2022", "COâ‚‚ Emissions": 14572.92 },
                { "Date": "8/31/2022", "COâ‚‚ Emissions": 38532.3 },
                { "Date": "9/30/2022", "COâ‚‚ Emissions": 69244.92 },
                { "Date": "10/31/2022", "COâ‚‚ Emissions": 81938.57 },
                { "Date": "11/30/2022", "COâ‚‚ Emissions": 117731.75 },
                { "Date": "12/31/2022", "COâ‚‚ Emissions": 125690.6 },
                { "Date": "1/31/2023", "COâ‚‚ Emissions": 113242.61 },
                { "Date": "2/28/2023", "COâ‚‚ Emissions": 102027.88 },
                { "Date": "3/31/2023", "COâ‚‚ Emissions": 114214.08 },
                { "Date": "4/30/2023", "COâ‚‚ Emissions": 84498.54 },
                { "Date": "5/31/2023", "COâ‚‚ Emissions": 56899.71 },
                { "Date": "6/30/2023", "COâ‚‚ Emissions": 33641.09 },
                { "Date": "7/31/2023", "COâ‚‚ Emissions": 17319.52 },
                { "Date": "8/31/2023", "COâ‚‚ Emissions": 36402.73 },
                { "Date": "9/30/2023", "COâ‚‚ Emissions": 50768.6 },
                { "Date": "10/31/2023", "COâ‚‚ Emissions": 60600.63 },
                { "Date": "11/30/2023", "COâ‚‚ Emissions": 53716.59 },
                { "Date": "12/31/2023", "COâ‚‚ Emissions": 68358.86 }
            ];
            const fremontData = [
                { "Date": "1/31/2022", "COâ‚‚ Emissions": 134163.34 },
                { "Date": "2/28/2022", "COâ‚‚ Emissions": 123558.62 },
                { "Date": "3/31/2022", "COâ‚‚ Emissions": 114358.71 },
                { "Date": "4/30/2022", "COâ‚‚ Emissions": 82761.84 },
                { "Date": "5/31/2022", "COâ‚‚ Emissions": 64692.6 },
                { "Date": "6/30/2022", "COâ‚‚ Emissions": 40124.89 },
                { "Date": "7/31/2022", "COâ‚‚ Emissions": 39004.79 },
                { "Date": "8/31/2022", "COâ‚‚ Emissions": 60424.46 },
                { "Date": "9/30/2022", "COâ‚‚ Emissions": 76653.42 },
                { "Date": "10/31/2022", "COâ‚‚ Emissions": 113304.15 },
                { "Date": "11/30/2022", "COâ‚‚ Emissions": 163426.7 },
                { "Date": "12/31/2022", "COâ‚‚ Emissions": 190873.49 },
                { "Date": "1/31/2023", "COâ‚‚ Emissions": 181487.92 },
                { "Date": "2/28/2023", "COâ‚‚ Emissions": 168043.03 },
                { "Date": "3/31/2023", "COâ‚‚ Emissions": 176658.75 },
                { "Date": "4/30/2023", "COâ‚‚ Emissions": 134944.22 },
                { "Date": "5/31/2023", "COâ‚‚ Emissions": 93691.33 },
                { "Date": "6/30/2023", "COâ‚‚ Emissions": 70527.76 },
                { "Date": "7/31/2023", "COâ‚‚ Emissions": 62984.46 },
                { "Date": "8/31/2023", "COâ‚‚ Emissions": 64807.31 },
                { "Date": "9/30/2023", "COâ‚‚ Emissions": 76673.75 },
                { "Date": "10/31/2023", "COâ‚‚ Emissions": 102512.84 },
                { "Date": "11/30/2023", "COâ‚‚ Emissions": 128025.65 },
                { "Date": "12/31/2023", "COâ‚‚ Emissions": 160894.75 }
            ];
            const districtOfficeData = [
                { "Date": "1/31/2022", "COâ‚‚ Emissions": 19650.59 },
                { "Date": "2/28/2022", "COâ‚‚ Emissions": 16612.13 },
                { "Date": "3/31/2022", "COâ‚‚ Emissions": 14897.92 },
                { "Date": "4/30/2022", "COâ‚‚ Emissions": 13292.41 },
                { "Date": "5/31/2022", "COâ‚‚ Emissions": 12692.34 },
                { "Date": "6/30/2022", "COâ‚‚ Emissions": 10668.46 },
                { "Date": "7/31/2022", "COâ‚‚ Emissions": 10634.39 },
                { "Date": "8/31/2022", "COâ‚‚ Emissions": 13183.8 },
                { "Date": "9/30/2022", "COâ‚‚ Emissions": 14540.77 },
                { "Date": "10/31/2022", "COâ‚‚ Emissions": 15635.16 },
                { "Date": "11/30/2022", "COâ‚‚ Emissions": 17342.41 },
                { "Date": "12/31/2022", "COâ‚‚ Emissions": 18744.35 },
                { "Date": "1/31/2023", "COâ‚‚ Emissions": 19055.1 },
                { "Date": "2/28/2023", "COâ‚‚ Emissions": 17302.0 },
                { "Date": "3/31/2023", "COâ‚‚ Emissions": 17494.31 },
                { "Date": "4/30/2023", "COâ‚‚ Emissions": 15310.25 },
                { "Date": "5/31/2023", "COâ‚‚ Emissions": 13456.81 },
                { "Date": "6/30/2023", "COâ‚‚ Emissions": 11964.8 },
                { "Date": "7/31/2023", "COâ‚‚ Emissions": 11954.79 },
                { "Date": "8/31/2023", "COâ‚‚ Emissions": 12383.04 },
                { "Date": "9/30/2023", "COâ‚‚ Emissions": 14057.19 },
                { "Date": "10/31/2023", "COâ‚‚ Emissions": 15176.57 },
                { "Date": "11/30/2023", "COâ‚‚ Emissions": 14984.53 },
                { "Date": "12/31/2023", "COâ‚‚ Emissions": 17021.44 }
            ];

            let labels = montaVistaData.map(data => data['Date'].trim());
            let montaVistaEmissions = montaVistaData.map(data => data['COâ‚‚ Emissions']);
            let homesteadEmissions = homesteadData.map(data => data['COâ‚‚ Emissions']);
            let cupertinoEmissions = cupertinoData.map(data => data['COâ‚‚ Emissions']);
            let fremontEmissions = fremontData.map(data => data['COâ‚‚ Emissions']);
            let lynbrookEmissions = lynbrookData.map(data => data['COâ‚‚ Emissions']);
            let districtOfficeEmissions = districtOfficeData.map(data => data['COâ‚‚ Emissions']);

            let ctx = document.getElementById('co2Chart').getContext('2d');
            let co2Chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        { label: 'MVHS', data: montaVistaEmissions, borderColor: '#6a0dad', backgroundColor: '#6a0dad', hidden: false }, // Purple
                        { label: 'HHS', data: homesteadEmissions, borderColor: '#228b22', backgroundColor: '#228b22', hidden: true }, // Green
                        { label: 'Cupertino', data: cupertinoEmissions, borderColor: '#808080', backgroundColor: '#808080', hidden: true }, // Grey
                        { label: 'Fremont', data: fremontEmissions, borderColor: '#ff0000', backgroundColor: '#ff0000', hidden: true }, // Red
                        { label: 'Lynbrook', data: lynbrookEmissions, borderColor: '#0000ff', backgroundColor: '#0000ff', hidden: true }, // Blue
                        { label: 'District Office', data: districtOfficeEmissions, borderColor: '#000000', backgroundColor: '#000000', hidden: true } // Black
                    ]
                },
                options: {
                    plugins: {
                        legend: {
                            display: false,
                            onClick: null
                        },
                        title: {
                            display: false,
                            font: {
                                size: 30
                            },
                            text: 'COâ‚‚ emissions, by school'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Reset buttons to neutral color and set Monta Vista as active
            const buttons = {
                'MVHS': document.getElementById('toggleMontaVista'),
                'HHS': document.getElementById('toggleHomestead'),
                'Cupertino': document.getElementById('toggleCupertino'),
                'Fremont': document.getElementById('toggleFremont'),
                'Lynbrook': document.getElementById('toggleLynbrook'),
                'District Office': document.getElementById('toggleDistrictOffice')
            };

            const colors = {
                'MVHS': 'purple',
                'HHS': 'green',
                'Cupertino': 'gray',
                'Fremont': 'red',
                'Lynbrook': 'blue',
                'District Office': 'black'
            };

            function resetButtons() {
                for (let key in buttons) {
                    buttons[key].className = 'btn bg-white-300 text-gray-700';
                }
            }

            function activateButton(school, color) {
                buttons[school].className = `btn bg-${color}-200 text-${color}-900`;
            }

            // Initialize Monta Vista as active
            resetButtons();
            activateButton('MVHS', 'purple');

            // Add event listeners for toggling button colors and datasets
            buttons['MVHS'].addEventListener('click', function () {
                toggleDataset(co2Chart, 'MVHS');
                this.classList.toggle(`bg-purple-200`);
                this.classList.toggle('bg-gray-300');
                this.classList.toggle('text-purple-900');
                this.classList.toggle('text-gray-700');
            });

            buttons['HHS'].addEventListener('click', function () {
                toggleDataset(co2Chart, 'HHS');
                this.classList.toggle(`bg-green-200`);
                this.classList.toggle('bg-gray-300');
                this.classList.toggle('text-green-900');
                this.classList.toggle('text-gray-700');
            });

            buttons['Cupertino'].addEventListener('click', function () {
                toggleDataset(co2Chart, 'Cupertino');
                this.classList.toggle(`bg-gray-200`);
                this.classList.toggle('bg-gray-300');
                this.classList.toggle('text-gray-900');
                this.classList.toggle('text-gray-700');
            });

            buttons['Fremont'].addEventListener('click', function () {
                toggleDataset(co2Chart, 'Fremont');
                this.classList.toggle(`bg-red-200`);
                this.classList.toggle('bg-gray-300');
                this.classList.toggle('text-red-900');
                this.classList.toggle('text-gray-700');
            });

            buttons['Lynbrook'].addEventListener('click', function () {
                toggleDataset(co2Chart, 'Lynbrook');
                this.classList.toggle(`bg-blue-200`);
                this.classList.toggle('bg-gray-300');
                this.classList.toggle('text-blue-900');
                this.classList.toggle('text-gray-700');
            });

            buttons['District Office'].addEventListener('click', function () {
                toggleDataset(co2Chart, 'District Office');
                this.classList.toggle(`bg-black`);
                this.classList.toggle('bg-gray-300');
                this.classList.toggle('text-white');
                this.classList.toggle('text-gray-700');
            });

            function toggleDataset(chart, label) {
                const dataset = chart.data.datasets.find(d => d.label === label);
                dataset.hidden = !dataset.hidden;
                chart.update();
            }
        });


        document.addEventListener('DOMContentLoaded', function () {
            const bar_data = [
                { category: 'Monta Vista', kwh: 678594.57, gas: 2603115.94, color: '#2e7d32' },
                { category: 'Homestead', kwh: 610366.41, gas: 633171.25, color: '#8e24aa' },
                { category: 'Lynbrook', kwh: 581030.6, gas: 418466.87, color: '#ffc0cb' },
                { category: 'Cupertino', kwh: 557092.78, gas: 581146.13, color: '#f39c12' },
                { category: 'Fremont', kwh: 258368.11, gas: 8037.95, color: '#e74c3c' }
            ];

            let ctx2 = document.getElementById('energyBarChart').getContext('2d');
            new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: bar_data.map(row => row.category),
                    datasets: [{
                        label: 'kWh COâ‚‚ emissions',
                        data: bar_data.map(row => row.kwh),
                        backgroundColor: "blue",
                    },
                    {
                        label: 'Gas COâ‚‚ emissions',
                        data: bar_data.map(row => row.gas),
                        backgroundColor: "orange",
                    }]
                },
                options: {
                    indexAxis: 'y',
                    scales: {
                        x: {
                            stacked: true
                        },
                        y: {
                            stacked: true
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                font: {
                                    size: 14
                                }
                            }
                        }
                    }
                }
            });

            let ctx3 = document.getElementById('usageChart').getContext('2d');
            new Chart(ctx3, {
                type: 'pie',
                data: {
                    labels: ["HVAC", "Lighting", "Computers/Electronics", "Water heating", "Food preparation & storage", "Other"],
                    datasets: [{
                        label: "Percentage:",
                        backgroundColor: ['#2e7d32','#8e24aa','#f39c12','#e74c3c','#ffc0cb', '#599cff'],
                        data: [42, 16.9, 9.5, 17.3, 6.1, 8.2]
                        //decreased lighting because higher efficiency, increased HVAC based on info from Steve; increased water heating because paper's data only accounted for tap/fountain use
                    }]
                },
                options: {
                    plugins: {
                        legend: {
                            labels: {
                                font: {
                                    size: 14
                                }
                            }
                        }
                    }
                }
            });
        });

        const reveals = document.querySelectorAll(".reveal");

        function reveal() {
            for (let i = 0; i < reveals.length; i++) {
                const windowHeight = window.innerHeight;
                const elementTop = reveals[i].getBoundingClientRect().top;
                const elementVisible = 150;

                if (elementTop < windowHeight - elementVisible) {
                    reveals[i].classList.add("active");
                } else {
                    reveals[i].classList.remove("active");
                }
            }
        }

        window.addEventListener("scroll", reveal);

        reveal();

        function scrollDown(wait_time) {
            const mainTitle = document.getElementById('main-title');
            const staticTitle = document.getElementById('static-title');
            setTimeout(() => {
                window.scrollBy({ top: window.innerHeight, behavior: 'smooth' });
            }, wait_time);
            window.addEventListener('scroll', function () {
                if (window.scrollY > window.innerHeight) {
                    staticTitle.classList.add('visible');
                    mainTitle.style.display = 'none';
                } else {
                    staticTitle.classList.remove('visible');
                    mainTitle.style.display = 'block';
                }
            });
        }

        window.addEventListener('load', scrollDown(1000));

        window.addEventListener('scroll', function () {
            const navbar = document.getElementById('navbar');
            if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight) {
                navbar.classList.add('visible');
            }
        });
    </script>
</body>

</html>
